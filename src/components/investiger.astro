---
import '../styles/invetiger.css'
---
<section class="research-carousel-section" id="investigacion">
  <h2 class="services-title">Líneas de Interés y Trabajo</h2>
  <p class="services-subtitle">Temas que llevo a producción: detección temprana, datos masivos, serverless y captura en campo.</p>
  <div class="slider-wrapper">
    <button class="slider-nav prev" aria-label="Anterior" data-dir="prev">‹</button>
    <button class="slider-nav next" aria-label="Siguiente" data-dir="next">›</button>
    <div class="slider-container">

      <!-- Tarjeta 1 -->
      <div class="card">
        <div class="card-icon">
          <i class="fas fa-brain"></i>
        </div>
        <h3>Detección de pérdidas y anomalías</h3>
        <p>Modelos para detectar patrones inusuales y reducir pérdidas no técnicas antes de que escalen.</p>
          <div class="botones">
        <span class="keyword">#MachineLearning</span>
        <span class="keyword">#Anomalías</span>
        </div>
      </div>

      <!-- Tarjeta 2 -->
      <div class="card">
        <div class="card-icon">
          <i class="fas fa-bolt"></i>
        </div>
        <h3>Procesamiento distribuido a gran escala</h3>
        <p>Spark/Dataproc para procesar volúmenes masivos y alimentar decisiones diarias sin cuellos de botella.</p>
           <div class="botones">
        <span class="keyword">#Dataproc</span>
        <span class="keyword">#BigData</span>
        </div>
      </div>

      <!-- Tarjeta 3 -->
      <div class="card">
        <div class="card-icon">
          <i class="fas fa-cloud"></i>
        </div>
        <h3>Arquitecturas serverless en campo</h3>
        <p>Cloud Run/Functions para orquestar eventos de campo con auditoría y cero mantenimiento de servidores.</p>
           <div class="botones">
        <span class="keyword">#Serverless</span>
        <span class="keyword">#Cloud</span>
           </div>
      </div>

      <!-- Tarjeta 4 -->
      <div class="card">
        <div class="card-icon">
          <i class="fas fa-network-wired"></i>
        </div>
        <h3>Integración móvil–nube–analítica</h3>
        <p>Captura obligatoria en apps de campo conectada a nube y analítica; datos listos para decidir.</p>
             <div class="botones">
        <span class="keyword">#Mobile</span>
        <span class="keyword">#IoT</span>
             </div>
      </div>

    </div>
    <div class="dots" aria-label="Indicadores de tarjetas"></div>
  </div>
  <script>
    if (typeof window !== 'undefined') {
      const container = document.querySelector('.research-carousel-section .slider-container');
      const prevBtn = document.querySelector('.research-carousel-section .slider-nav.prev');
      const nextBtn = document.querySelector('.research-carousel-section .slider-nav.next');
      const getStep = () => {
        const card = container?.querySelector('.card');
        if (!card) return 320;
        const cardWidth = card.getBoundingClientRect().width;
        const gap = 16; // keep in sync with CSS gap
        return cardWidth + gap;
      };

      const dotsContainer = document.querySelector('.research-carousel-section .dots');
      const cards = Array.from(container?.querySelectorAll('.card') || []);
      const slides = Math.max(1, Math.ceil(cards.length / 2)); // 2 cards visibles, 2 dots para 4 cards

      // Crear dots (solo 2 en este caso)
      if (dotsContainer && cards.length) {
        for (let i = 0; i < slides; i++) {
          const dot = document.createElement('button');
          dot.className = 'dot';
          dot.setAttribute('aria-label', `Ir al grupo ${i + 1}`);
          dot.addEventListener('click', () => {
            const step = getStep();
            const offset = i * step * 2; // avanzar de dos en dos para mostrar el siguiente par
            container?.scrollTo({ left: offset, behavior: 'smooth' });
          });
          dotsContainer.appendChild(dot);
        }
      }

      const setActiveDot = () => {
        if (!dotsContainer || !cards.length) return;
        const scrollLeft = container?.scrollLeft || 0;
        const step = getStep();
        const index = Math.round(scrollLeft / (step * 2)); // 2 tarjetas por vista
        dotsContainer.querySelectorAll('.dot').forEach((dot, i) => {
          dot.classList.toggle('active', i === index);
        });
      };

      const scrollByStep = (dir) => {
        const step = getStep();
        container?.scrollBy({ left: dir === 'next' ? step : -step, behavior: 'smooth' });
      };
      prevBtn?.addEventListener('click', () => scrollByStep('prev'));
      nextBtn?.addEventListener('click', () => scrollByStep('next'));
      container?.addEventListener('scroll', () => {
        window.clearTimeout(container._dotTimeout);
        container._dotTimeout = window.setTimeout(setActiveDot, 80);
      });
      setActiveDot();
    }
  </script>
</section>
